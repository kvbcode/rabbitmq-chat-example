## Пример работы с RabbitMQ через Java клиент

Проект представляет из себя прототип сетевого чата. Общение между компонентами происходит только через брокер.

Компонент сервера выполняет функцию анонсирования событий и регистрацию появления пользователей. 

Клиенты могут регистрироваться на сервере и запрашивать новое имя для общения. В дальнейшем они отправляют и получают сообщения через общую точку обмена на брокере.

Реализованы следующие способы обмена сообщениями:

- **DirectExcange** (REGISTRATION_EXCHANGE = "example.chat.reg") используется для уведомления сервера об новом пользователе. Серверов может быть несколько. Тогда сообщения будут распределены между ними по очереди.
- **FanoutExchange** (MESSAGES_EXCHANGE = "example.chat.msg") общая точка получения сообщений. Каждый из клиентов связывает с ней свою собственную очередь.
- **RPC** (LoginRpcServer) - сервер получает запрос на регистрацию и возвращает имя пользователю.

### Сборка и запуск

RabbitMQ легче всего запустить из докер-образа. Web-интерфейс будет доступен по адресу http://localhost:15672. Имя пользователя `guest`, пароль `guest`.

```
docker run --rm -it -p 15672:15672 -p 5672:5672 rabbitmq:3.11-management
```

Модули можно запускать из корневой папки проекта или выполнять запуск `mvn exec:java` в подкаталогах. Можно запускать любое количество клиентов и серверов.

```
mvn exec:java -pl chat-server
mvn exec:java -pl chat-client
mvn exec:java -pl chat-client -Dexec.args="auto"
```

### `chat-server`

Получает от пользователя RPC запрос и возвращает ему имя. Для упрощения, имя генерируется на сервере в виде `User-1`. Счетчик будет увеличен при каждом запросе.

Каждую минуту сервер сообщает в общий чат свое локальное время.

### `chat-client`

Запрашивает у сервера новое имя пользователя и использует в дальнейшем. Возможна работа в 2-х режимах.
- ручной (по умолчанию). Пользователь сам пишет сообщение в консоли и оно рассылается остальным клиентам через точку обмена.
- автоматический. Клиент автоматически отправляет сообщение каждые 5 секунд.

Для работы в автоматическом режиме передайте параметр командной строки `auto`.